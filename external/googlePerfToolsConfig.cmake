# Finds and configures google-perftools if it exists on the system. 
# Andre Anjos - 07.september.2010

# We start by defining GOOGLE_PERFTOOLS_FOUND to false
set(GOOGLE_PERFTOOLS_FOUND "NO" CACHE INTERNAL "package")

# Here we do some variable cleanup and adjustments
find_path(GOOGLE_PERFTOOLS_INCLUDE_1 NAMES google/profiler.h)
set(GOOGLE_PERFTOOLS_INCLUDE_DIRS ${GOOGLE_PERFTOOLS_INCLUDE_1})
find_path(GOOGLE_PERFTOOLS_INCLUDE_2 NAMES google/tcmalloc.h)
set(GOOGLE_PERFTOOLS_INCLUDE_DIRS "${GOOGLE_PERFTOOLS_INCLUDE_DIRS};${GOOGLE_PERFTOOLS_INCLUDE_2}")
list(REMOVE_DUPLICATES GOOGLE_PERFTOOLS_INCLUDE_DIRS)

find_library(GOOGLE_PERFTOOLS_LIBRARY NAMES profiler)
set(GOOGLE_PERFTOOLS_LIBRARIES ${GOOGLE_PERFTOOLS_LIBRARY} CACHE INTERNAL "libraries")

if(GOOGLE_PERFTOOLS_INCLUDE_1 AND GOOGLE_PERFTOOLS_INCLUDE_2 AND GOOGLE_PERFTOOLS_LIBRARY)
  set(GOOGLE_PERFTOOLS_FOUND "YES" CACHE INTERNAL "package")
  include_directories(SYSTEM ${GOOGLE_PERFTOOLS_INCLUDE_DIRS})
  add_definitions(-DHAVE_GOOGLE_PERFTOOLS=1)
endif()
  
find_package_message(GOOGLE_PERFTOOLS "Found Google PerfTools: ${GOOGLE_PERFTOOLS_INCLUDE_DIRS}" "[${GOOGLE_PERFTOOLS_INCLUDE_DIRS}][${GOOGLE_PERFTOOLS_LIBRARIES}]")
